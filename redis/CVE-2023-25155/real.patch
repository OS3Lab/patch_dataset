diff --git a/src/t_set.c b/src/t_set.c
index 504db1206..c2dbe0a78 100644
--- a/src/t_set.c
+++ b/src/t_set.c
@@ -626,6 +626,10 @@ void srandmemberWithCountCommand(client *c) {
     dict *d;
 
     if (getLongFromObjectOrReply(c,c->argv[2],&l,NULL) != C_OK) return;
+    if (l<-LONG_MAX) {
+        addReplyError(c, "value is out of range");
+        return;
+    }
     if (l >= 0) {
         count = (unsigned long) l;
     } else {
diff --git a/tests/unit/type/set.tcl b/tests/unit/type/set.tcl
index 5df1af289..d4ceae011 100644
--- a/tests/unit/type/set.tcl
+++ b/tests/unit/type/set.tcl
@@ -554,6 +554,11 @@ start_server {
         r srandmember nonexisting_key 100
     } {}
 
+    test "SRANDMEMBER count overflow" {
+        r sadd myset a
+        assert_error {*value is out of range*} {r srandmember myset -9223372036854775808}
+    } {}
+
     foreach {type contents} {
         hashtable {
             1 5 10 50 125 50000 33959417 4775547 65434162
