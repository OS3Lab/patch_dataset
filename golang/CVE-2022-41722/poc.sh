#!/bin/bash
set -euxo pipefail

backport_patch="3345ddca41f00f9ed6fc3c1a36f6e2bede02d7ff"
test_file=("src/path/filepath/path_test.go" "src/path/filepath/path_windows_test.go")

for file in ${test_file[@]}; do
    git checkout ${backport_patch} -- ${file}
done

cd src
go mod tidy
../bin/go test path/filepath -run TestIssue52476