From f3ae7de2c04819a1cd33205e802b19e86d227213 Mon Sep 17 00:00:00 2001
From: Sara Golemon <sara.golemon@mongodb.com>
Date: Fri, 26 Jun 2020 14:44:02 +0000
Subject: [PATCH] SERVER-49142 Validate correct field name in
 RoleName::parseFromBSON()

(cherry picked from commit e43e383fd690f8dd930c1e912853d7ad7e0248e9)
---
 src/mongo/db/auth/role_name.cpp | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/src/mongo/db/auth/role_name.cpp b/src/mongo/db/auth/role_name.cpp
index d3c16e771bb..271a3f4366d 100644
--- a/src/mongo/db/auth/role_name.cpp
+++ b/src/mongo/db/auth/role_name.cpp
@@ -67,7 +67,7 @@ RoleName RoleName::parseFromBSON(const BSONElement& elem) {
     const auto& dbField = fields[1];
     uassert(ErrorCodes::BadValue,
             "role name must contain a string field named: db",
-            nameField.type() == String);
+            dbField.type() == String);
 
     return RoleName(nameField.valueStringData(), dbField.valueStringData());
 }
-- 
2.34.1

